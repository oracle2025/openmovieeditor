// generated by Fast Light User Interface Designer (fluid) version 1.0106

#include "nle.h"

inline void NleUI::cb_Open_i(Fl_Menu_*, void*) {
  nle::Project::read_project();
mainWindow->redraw();
}
void NleUI::cb_Open(Fl_Menu_* o, void* v) {
  ((NleUI*)(o->parent()->user_data()))->cb_Open_i(o,v);
}

inline void NleUI::cb_Save_i(Fl_Menu_*, void*) {
  //nle::Renderer a("/home/oracle/t.mov", 368, 240, 25, 48000);
//a.go();
nle::Project::write_project();
}
void NleUI::cb_Save(Fl_Menu_* o, void* v) {
  ((NleUI*)(o->parent()->user_data()))->cb_Save_i(o,v);
}

inline void NleUI::cb_Render_i(Fl_Menu_*, void*) {
  Fl_Group::current( mainWindow );
EncodeDialog dlg;
dlg.show();
while (dlg.shown())
  Fl::wait();
}
void NleUI::cb_Render(Fl_Menu_* o, void* v) {
  ((NleUI*)(o->parent()->user_data()))->cb_Render_i(o,v);
}

Fl_Menu_Item NleUI::menu_[] = {
 {"&File", 0,  0, 0, 64, 0, 0, 14, 56},
 {"New", 0,  0, 0, 0, 0, 0, 14, 56},
 {"Open...", 0,  (Fl_Callback*)NleUI::cb_Open, 0, 128, 0, 0, 14, 56},
 {"Save", 0,  (Fl_Callback*)NleUI::cb_Save, 0, 0, 0, 0, 14, 56},
 {"Save as...", 0,  0, 0, 128, 0, 0, 14, 56},
 {"Render...", 0,  (Fl_Callback*)NleUI::cb_Render, 0, 128, 0, 0, 14, 56},
 {"Quit", 0,  0, 0, 0, 0, 0, 14, 56},
 {0,0,0,0,0,0,0,0,0},
 {0,0,0,0,0,0,0,0,0}
};

inline void NleUI::cb__i(Fl_Button*, void*) {
  m_videoView->play();
}
void NleUI::cb_(Fl_Button* o, void* v) {
  ((NleUI*)(o->parent()->parent()->parent()->parent()->user_data()))->cb__i(o,v);
}

inline void NleUI::cb_1_i(Fl_Button*, void*) {
  m_videoView->stop();
}
void NleUI::cb_1(Fl_Button* o, void* v) {
  ((NleUI*)(o->parent()->parent()->parent()->parent()->user_data()))->cb_1_i(o,v);
}

inline void NleUI::cb_PAL_i(Fl_Menu_*, void*) {
  g_fps = 25.0;
std::cout << "PAL" << std::endl;
}
void NleUI::cb_PAL(Fl_Menu_* o, void* v) {
  ((NleUI*)(o->parent()->parent()->parent()->parent()->parent()->parent()->user_data()))->cb_PAL_i(o,v);
}

inline void NleUI::cb_NTSC_i(Fl_Menu_*, void*) {
  g_fps = 29.97;
std::cout << "NTSC" << std::endl;
}
void NleUI::cb_NTSC(Fl_Menu_* o, void* v) {
  ((NleUI*)(o->parent()->parent()->parent()->parent()->parent()->parent()->user_data()))->cb_NTSC_i(o,v);
}

Fl_Menu_Item NleUI::menu_FPS[] = {
 {"PAL 25", 0,  (Fl_Callback*)NleUI::cb_PAL, 0, 0, 0, 0, 14, 56},
 {"NTSC 29.97", 0,  (Fl_Callback*)NleUI::cb_NTSC, 0, 0, 0, 0, 14, 56},
 {0,0,0,0,0,0,0,0,0}
};

inline void NleUI::cb_fileBrowser_i(nle::FileBrowser* o, void*) {
  nle::FileBrowser *fb = (nle::FileBrowser*)o;
fb->load_rel();
}
void NleUI::cb_fileBrowser(nle::FileBrowser* o, void* v) {
  ((NleUI*)(o->parent()->parent()->parent()->parent()->parent()->parent()->user_data()))->cb_fileBrowser_i(o,v);
}

#include <FL/Fl_Pixmap.H>
static const char *idata_tool_positioning[] = {
"32 32 2 1",
" \tc None",
".\tc #000000",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"       .                .       ",
"      ..                ..      ",
"     ...                ...     ",
"    ....                ....    ",
"   ..........................   ",
"    ....                ....    ",
"     ...                ...     ",
"      ..                ..      ",
"       .                .       ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                ",
"                                "
};
static Fl_Pixmap image_tool_positioning(idata_tool_positioning);

static const char *idata_tool_automations[] = {
"32 32 2 1",
" \tc None",
".\tc #000000",
"                                ",
"                                ",
"                                ",
"                                ",
"                .               ",
"               ...              ",
"              .....             ",
"             .......            ",
"            .........           ",
"                .               ",
"                .               ",
"                .               ",
"                .               ",
"                                ",
"                  .             ",
"              .....             ",
"              .....             ",
"              .....             ",
"              .....             ",
"             ......             ",
"                                ",
"                .               ",
"                .               ",
"                .               ",
"                .               ",
"            .........           ",
"             .......            ",
"              .....             ",
"               ...              ",
"                .               ",
"                                ",
"                                "
};
static Fl_Pixmap image_tool_automations(idata_tool_automations);

inline void NleUI::cb_scaleBar_i(Flmm_Scalebar* o, void*) {
  Flmm_Scalebar *sb = (Flmm_Scalebar *)o;
float width = sb->w();
float slider_size = sb->slider_size_i();
float zoom = width / slider_size;
m_timelineView->scroll( (int64_t)sb->value() );
m_timelineView->zoom( zoom );
}
void NleUI::cb_scaleBar(Flmm_Scalebar* o, void* v) {
  ((NleUI*)(o->parent()->user_data()))->cb_scaleBar_i(o,v);
}

static const char *idata_trash[] = {
"16 16 4 1",
" \tc None",
".\tc #000000",
"+\tc #B3B3B3",
"@\tc #404040",
"     .......    ",
"   ...+++++...  ",
"  ..+++...+++.. ",
" ..+++.+++.+++..",
" ..+++++++++++..",
"  ..+++++++++.. ",
"  ....+++++.... ",
"  .++.......++. ",
"  .++@++@++@++. ",
"  .++@++@++@++. ",
"  .++@++@++@++. ",
"  .++@++@++@++. ",
"  .++@++@++@++. ",
"  ..+@++@++@+.. ",
"   ...++@++...  ",
"     .......    "
};
static Fl_Pixmap image_trash(idata_trash);

NleUI::NleUI() {
  Fl_Double_Window* w;
  { Fl_Double_Window* o = mainWindow = new Fl_Double_Window(515, 475, "MovieEditor");
    w = o;
    o->user_data((void*)(this));
    { Fl_Menu_Bar* o = new Fl_Menu_Bar(0, 0, 515, 25);
      o->menu(menu_);
    }
    { Fl_Tile* o = new Fl_Tile(0, 25, 515, 410);
      { Fl_Group* o = new Fl_Group(0, 25, 515, 250);
        { Fl_Group* o = new Fl_Group(275, 25, 240, 250);
          { nle::VideoViewGL* o = m_videoView = new nle::VideoViewGL(275, 25, 240, 225, "VideoView");
            o->box(FL_DOWN_BOX);
            o->color(FL_BACKGROUND_COLOR);
            o->selection_color(FL_BACKGROUND_COLOR);
            o->labeltype(FL_NORMAL_LABEL);
            o->labelfont(0);
            o->labelsize(14);
            o->labelcolor(FL_GRAY0);
            o->align(FL_ALIGN_CENTER);
            o->when(FL_WHEN_RELEASE);
            Fl_Group::current()->resizable(o);
          }
          { Fl_Button* o = new Fl_Button(395, 250, 60, 25, "@>");
            o->callback((Fl_Callback*)cb_);
          }
          new Fl_Button(455, 250, 60, 25, "@>|");
          new Fl_Button(275, 250, 60, 25, "@|<");
          { Fl_Button* o = new Fl_Button(335, 250, 60, 25, "@||");
            o->callback((Fl_Callback*)cb_1);
          }
          o->end();
        }
        { Fl_Group* o = new Fl_Group(0, 25, 275, 250);
          { Fl_Tabs* o = new Fl_Tabs(0, 25, 275, 250);
            o->box(FL_UP_BOX);
            o->labelcolor(FL_GRAY0);
            { Fl_Group* o = new Fl_Group(0, 50, 275, 225, "Project");
              { Fl_Value_Input* o = new Fl_Value_Input(55, 60, 100, 25, "Width");
                o->maximum(1024);
                o->step(1);
                o->value(640);
              }
              { Fl_Value_Input* o = new Fl_Value_Input(55, 90, 100, 25, "Height");
                o->maximum(768);
                o->step(1);
                o->value(480);
              }
              { Fl_Box* o = new Fl_Box(185, 185, 85, 35);
                Fl_Group::current()->resizable(o);
              }
              { Fl_Choice* o = new Fl_Choice(55, 120, 100, 25, "FPS");
                o->down_box(FL_BORDER_BOX);
                o->menu(menu_FPS);
              }
              { Fl_Value_Input* o = new Fl_Value_Input(55, 150, 100, 25, "Rate");
                o->minimum(32000);
                o->maximum(48000);
                o->step(1);
                o->value(48000);
                o->deactivate();
              }
              o->end();
              Fl_Group::current()->resizable(o);
            }
            { Fl_Group* o = new Fl_Group(0, 50, 275, 225, "Files");
              o->hide();
              { nle::FileBrowser* o = fileBrowser = new nle::FileBrowser(5, 55, 265, 210);
                o->box(FL_NO_BOX);
                o->color(FL_BACKGROUND2_COLOR);
                o->selection_color(FL_SELECTION_COLOR);
                o->labeltype(FL_NORMAL_LABEL);
                o->labelfont(0);
                o->labelsize(14);
                o->labelcolor(FL_BLACK);
                o->callback((Fl_Callback*)cb_fileBrowser);
                o->align(FL_ALIGN_BOTTOM);
                o->when(FL_WHEN_RELEASE_ALWAYS);
                Fl_Group::current()->resizable(o);
              }
              o->end();
            }
            { Fl_Group* o = new Fl_Group(0, 50, 275, 225, "Object Inspector");
              o->hide();
              { Fl_Menu_Button* o = new Fl_Menu_Button(80, 55, 190, 25, "Font");
                o->align(FL_ALIGN_LEFT);
              }
              { Fl_Value_Input* o = new Fl_Value_Input(80, 85, 190, 25, "Font Size");
                o->maximum(40);
                o->step(1);
              }
              { Fl_Text_Editor* o = new Fl_Text_Editor(80, 115, 190, 155, "Text");
                o->align(FL_ALIGN_LEFT);
                Fl_Group::current()->resizable(o);
              }
              o->end();
            }
            o->end();
            Fl_Group::current()->resizable(o);
          }
          o->end();
        }
        o->end();
      }
      { Fl_Group* o = new Fl_Group(0, 275, 515, 160);
        { Fl_Group* o = new Fl_Group(50, 275, 465, 160);
          { nle::Ruler* o = new nle::Ruler(50, 275, 465, 25, "Ruler");
            o->box(FL_UP_BOX);
            o->color(FL_BACKGROUND_COLOR);
            o->selection_color(FL_BACKGROUND_COLOR);
            o->labeltype(FL_NORMAL_LABEL);
            o->labelfont(0);
            o->labelsize(14);
            o->labelcolor(FL_BLACK);
            o->align(FL_ALIGN_CENTER|FL_ALIGN_INSIDE);
            o->when(FL_WHEN_RELEASE);
          }
          { nle::TimelineView* o = m_timelineView = new nle::TimelineView(50, 300, 465, 135);
            o->box(FL_NO_BOX);
            o->color(FL_BACKGROUND_COLOR);
            o->selection_color(FL_BACKGROUND_COLOR);
            o->labeltype(FL_NORMAL_LABEL);
            o->labelfont(0);
            o->labelsize(14);
            o->labelcolor(FL_BLACK);
            o->align(FL_ALIGN_CENTER);
            o->when(2);
            Fl_Group::current()->resizable(o);
          }
          o->end();
          Fl_Group::current()->resizable(o);
        }
        { Fl_Group* o = new Fl_Group(0, 275, 50, 160);
          o->box(FL_UP_BOX);
          o->labelsize(12);
          { Fl_Box* o = new Fl_Box(5, 300, 39, 74);
            o->box(FL_DOWN_BOX);
          }
          { Fl_Button* o = new Fl_Button(7, 302, 35, 35);
            o->tooltip("Positioning");
            o->type(102);
            o->value(1);
            o->image(image_tool_positioning);
            o->align(FL_ALIGN_CENTER|FL_ALIGN_INSIDE);
          }
          { Fl_Button* o = new Fl_Button(7, 337, 35, 35);
            o->tooltip("Automations");
            o->type(102);
            o->image(image_tool_automations);
            o->align(FL_ALIGN_BOTTOM|FL_ALIGN_INSIDE);
          }
          { Fl_Box* o = new Fl_Box(15, 380, 17, 55);
            Fl_Group::current()->resizable(o);
          }
          { Fl_Box* o = new Fl_Box(0, 275, 50, 25, "Tools");
            o->labelsize(12);
          }
          o->end();
        }
        o->end();
      }
      o->end();
      Fl_Group::current()->resizable(o);
    }
    { Flmm_Scalebar* o = scaleBar = new Flmm_Scalebar(0, 435, 515, 20);
      o->type(1);
      o->box(FL_FLAT_BOX);
      o->color(FL_DARK2);
      o->selection_color(FL_BACKGROUND_COLOR);
      o->labeltype(FL_NORMAL_LABEL);
      o->labelfont(0);
      o->labelsize(14);
      o->labelcolor(FL_BLACK);
      o->maximum(1024);
      o->slider_size(0.40404);
      o->callback((Fl_Callback*)cb_scaleBar);
      o->align(FL_ALIGN_BOTTOM);
      o->when(FL_WHEN_CHANGED);
    }
    { Fl_Group* o = new Fl_Group(0, 455, 515, 20);
      o->box(FL_ENGRAVED_BOX);
      { Fl_Box* o = trashCan = new Fl_Box(490, 455, 25, 20);
        o->box(FL_UP_BOX);
        o->image(image_trash);
      }
      { Fl_Box* o = new Fl_Box(330, 460, 25, 15);
        Fl_Group::current()->resizable(o);
      }
      o->end();
    }
    o->end();
  }
}

void NleUI::show( int argc, char **argv ) {
  g_fps = 25.0;
g_scrollBar = scaleBar;
g_trashCan = trashCan;
scaleBar->slider_size_i(300);
mainWindow->show(argc, argv);
}
Flmm_Scalebar* g_scrollBar;

inline void EncodeDialog::cb_Encode_i(Fl_Return_Button* o, void*) {
  //nle::renderMovie();
o->window()->hide();
}
void EncodeDialog::cb_Encode(Fl_Return_Button* o, void* v) {
  ((EncodeDialog*)(o->parent()->user_data()))->cb_Encode_i(o,v);
}

inline void EncodeDialog::cb_Cancel_i(Fl_Button* o, void*) {
  o->window()->hide();
}
void EncodeDialog::cb_Cancel(Fl_Button* o, void* v) {
  ((EncodeDialog*)(o->parent()->user_data()))->cb_Cancel_i(o,v);
}

inline void EncodeDialog::cb_audio_codec_menu_i(Fl_Choice* o, void*) {
  audio_codec = o->menu()[o->value()].user_data();
}
void EncodeDialog::cb_audio_codec_menu(Fl_Choice* o, void* v) {
  ((EncodeDialog*)(o->parent()->user_data()))->cb_audio_codec_menu_i(o,v);
}

inline void EncodeDialog::cb_video_codec_menu_i(Fl_Choice* o, void*) {
  video_codec = o->menu()[o->value()].user_data();
}
void EncodeDialog::cb_video_codec_menu(Fl_Choice* o, void* v) {
  ((EncodeDialog*)(o->parent()->user_data()))->cb_video_codec_menu_i(o,v);
}

Fl_Menu_Item EncodeDialog::menu_Samplerate[] = {
 {"48000", 0,  0, 0, 0, 0, 0, 14, 56},
 {0,0,0,0,0,0,0,0,0}
};

Fl_Menu_Item EncodeDialog::menu_Framerate[] = {
 {"25 (PAL)", 0,  0, 0, 0, 0, 0, 14, 56},
 {0,0,0,0,0,0,0,0,0}
};

Fl_Menu_Item EncodeDialog::menu_Framesize[] = {
 {"720x576", 0,  0, 0, 0, 0, 0, 14, 56},
 {"360x288", 0,  0, 0, 0, 0, 0, 14, 56},
 {"180x144", 0,  0, 0, 0, 0, 0, 14, 56},
 {0,0,0,0,0,0,0,0,0}
};

inline void EncodeDialog::cb_audio_options_i(Fl_Button*, void*) {
  if ( audio_codec ) {
	Fl_Group::current( encodeDialog );
	CodecOptions dlg;
	nle::setCodecInfo( &dlg, audio_codec );
	dlg.codecOptions->show();
	while (dlg.codecOptions->shown())
		Fl::wait();
};
}
void EncodeDialog::cb_audio_options(Fl_Button* o, void* v) {
  ((EncodeDialog*)(o->parent()->user_data()))->cb_audio_options_i(o,v);
}

inline void EncodeDialog::cb_video_options_i(Fl_Button*, void*) {
  if ( video_codec ) {
	Fl_Group::current( encodeDialog );
	CodecOptions dlg;
	nle::setCodecInfo( &dlg, video_codec );
	dlg.codecOptions->show();
	while (dlg.codecOptions->shown())
		Fl::wait();
};
}
void EncodeDialog::cb_video_options(Fl_Button* o, void* v) {
  ((EncodeDialog*)(o->parent()->user_data()))->cb_video_options_i(o,v);
}

EncodeDialog::EncodeDialog() {
  Fl_Double_Window* w;
  { Fl_Double_Window* o = encodeDialog = new Fl_Double_Window(485, 280, "Render");
    w = o;
    o->user_data((void*)(this));
    { Fl_Return_Button* o = new Fl_Return_Button(245, 240, 205, 25, "Encode");
      o->callback((Fl_Callback*)cb_Encode);
      w->hotspot(o);
    }
    { Fl_Button* o = new Fl_Button(30, 240, 200, 25, "Cancel");
      o->callback((Fl_Callback*)cb_Cancel);
    }
    { Fl_Choice* o = audio_codec_menu = new Fl_Choice(145, 75, 205, 25, "Audio Codec");
      o->down_box(FL_BORDER_BOX);
      o->callback((Fl_Callback*)cb_audio_codec_menu);
    }
    { Fl_Choice* o = video_codec_menu = new Fl_Choice(145, 105, 205, 25, "Video Codec");
      o->down_box(FL_BORDER_BOX);
      o->callback((Fl_Callback*)cb_video_codec_menu);
    }
    { Fl_Choice* o = new Fl_Choice(145, 135, 205, 25, "Samplerate");
      o->down_box(FL_BORDER_BOX);
      o->menu(menu_Samplerate);
    }
    { Fl_Choice* o = new Fl_Choice(145, 165, 205, 25, "Framerate");
      o->down_box(FL_BORDER_BOX);
      o->menu(menu_Framerate);
    }
    { Fl_Choice* o = new Fl_Choice(145, 195, 205, 25, "Framesize");
      o->down_box(FL_BORDER_BOX);
      o->menu(menu_Framesize);
    }
    { Fl_Box* o = new Fl_Box(0, 0, 485, 35, "Export");
      o->labelfont(1);
      o->labelsize(16);
    }
    { Fl_Button* o = audio_options = new Fl_Button(355, 75, 75, 25, "Options...");
      o->callback((Fl_Callback*)cb_audio_options);
    }
    { Fl_Button* o = video_options = new Fl_Button(355, 105, 75, 25, "Options...");
      o->callback((Fl_Callback*)cb_video_options);
    }
    new Fl_File_Input(145, 35, 205, 35, "Filename");
    new Fl_Button(355, 45, 75, 25, "File...");
    o->set_modal();
    o->end();
  }
}

void EncodeDialog::show() {
  audio_codec = 0;
video_codec = 0;
nle::setAudioCodecMenu( audio_codec_menu );
nle::setVideoCodecMenu( video_codec_menu );
encodeDialog->show();
}

int EncodeDialog::shown() {
  return encodeDialog->shown();
}

ChangesDialog::ChangesDialog() {
  Fl_Double_Window* w;
  { Fl_Double_Window* o = new Fl_Double_Window(410, 80, "Unsaved changes!");
    w = o;
    o->user_data((void*)(this));
    new Fl_Box(5, 10, 385, 25, "Save changes?");
    new Fl_Button(5, 50, 120, 25, "Don\'t Save");
    new Fl_Button(160, 50, 120, 25, "Cancel");
    new Fl_Return_Button(285, 50, 120, 25, "Save");
    o->end();
  }
}
Fl_Box *g_trashCan;
float g_fps;

inline void CodecOptions::cb_parameters_browser_i(Fl_Hold_Browser*, void*) {
  if ( parameters_browser->value() ) {
	nle::setCodecParameter( this, parameters_browser->data( parameters_browser->value() ) );
};
}
void CodecOptions::cb_parameters_browser(Fl_Hold_Browser* o, void* v) {
  ((CodecOptions*)(o->parent()->parent()->user_data()))->cb_parameters_browser_i(o,v);
}

inline void CodecOptions::cb_Cancel1_i(Fl_Button* o, void*) {
  o->window()->hide();
}
void CodecOptions::cb_Cancel1(Fl_Button* o, void* v) {
  ((CodecOptions*)(o->parent()->parent()->user_data()))->cb_Cancel1_i(o,v);
}

CodecOptions::CodecOptions() {
  Fl_Double_Window* w;
  { Fl_Double_Window* o = codecOptions = new Fl_Double_Window(345, 305, "Codec Options");
    w = o;
    o->user_data((void*)(this));
    { Fl_Box* o = codec_label = new Fl_Box(0, 0, 345, 35, "Codec");
      o->labelfont(1);
      o->labelsize(16);
    }
    { Fl_Group* o = new Fl_Group(0, 35, 345, 230);
      { Fl_Hold_Browser* o = parameters_browser = new Fl_Hold_Browser(5, 40, 165, 220);
        o->box(FL_NO_BOX);
        o->color(FL_BACKGROUND2_COLOR);
        o->selection_color(FL_SELECTION_COLOR);
        o->labeltype(FL_NORMAL_LABEL);
        o->labelfont(0);
        o->labelsize(14);
        o->labelcolor(FL_BLACK);
        o->callback((Fl_Callback*)cb_parameters_browser);
        o->align(FL_ALIGN_BOTTOM);
        o->when(FL_WHEN_RELEASE_ALWAYS);
        Fl_Group::current()->resizable(o);
      }
      { Fl_Group* o = new Fl_Group(170, 35, 175, 230);
        { Fl_Value_Input* o = parameter_int_input = new Fl_Value_Input(175, 40, 165, 25);
          o->step(1);
          o->deactivate();
        }
        { Fl_Input* o = parameter_string_input = new Fl_Input(175, 70, 165, 25);
          o->deactivate();
        }
        { Fl_Choice* o = parameter_stringlist_input = new Fl_Choice(175, 100, 165, 25);
          o->down_box(FL_BORDER_BOX);
          o->deactivate();
        }
        { Fl_Box* o = new Fl_Box(230, 175, 25, 25);
          Fl_Group::current()->resizable(o);
        }
        o->end();
      }
      o->end();
      Fl_Group::current()->resizable(o);
    }
    { Fl_Group* o = new Fl_Group(0, 265, 345, 40);
      { Fl_Button* o = new Fl_Button(20, 275, 140, 25, "Cancel");
        o->callback((Fl_Callback*)cb_Cancel1);
      }
      { Fl_Return_Button* o = new Fl_Return_Button(185, 275, 140, 25, "Ok");
        w->hotspot(o);
      }
      o->end();
    }
    o->set_modal();
    o->end();
  }
}
